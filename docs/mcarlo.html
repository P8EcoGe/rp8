<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 Simulations de Monte-Carlo | R à Paris 8</title>
  <meta name="description" content="4 Simulations de Monte-Carlo | R à Paris 8" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="4 Simulations de Monte-Carlo | R à Paris 8" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 Simulations de Monte-Carlo | R à Paris 8" />
  
  
  



<meta name="date" content="2021-09-09" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="sum.html"/>
<link rel="next" href="MCO.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Préface</a></li>
<li class="chapter" data-level="2" data-path="R-intro.html"><a href="R-intro.html"><i class="fa fa-check"></i><b>2</b> Introduction à <code>R</code></a>
<ul>
<li class="chapter" data-level="2.1" data-path="R-intro.html"><a href="R-intro.html#introduction"><i class="fa fa-check"></i><b>2.1</b> Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="R-intro.html"><a href="R-intro.html#démarrer-r-et-r-studio"><i class="fa fa-check"></i><b>2.2</b> Démarrer R et R Studio</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="R-intro.html"><a href="R-intro.html#un-premier-glossaire"><i class="fa fa-check"></i><b>2.2.1</b> Un premier glossaire</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="R-intro.html"><a href="R-intro.html#calculs-de-base"><i class="fa fa-check"></i><b>2.3</b> Calculs de base</a></li>
<li class="chapter" data-level="2.4" data-path="R-intro.html"><a href="R-intro.html#obtenir-de-laide"><i class="fa fa-check"></i><b>2.4</b> Obtenir de l’aide</a></li>
<li class="chapter" data-level="2.5" data-path="R-intro.html"><a href="R-intro.html#installation-de-packages"><i class="fa fa-check"></i><b>2.5</b> Installation de packages</a></li>
<li class="chapter" data-level="2.6" data-path="R-intro.html"><a href="R-intro.html#code-output"><i class="fa fa-check"></i><b>2.6</b> <code>Code</code> et sortie dans ce document</a></li>
<li class="chapter" data-level="2.7" data-path="R-intro.html"><a href="R-intro.html#data-types"><i class="fa fa-check"></i><b>2.7</b> Types de données</a></li>
<li class="chapter" data-level="2.8" data-path="R-intro.html"><a href="R-intro.html#structures-de-données"><i class="fa fa-check"></i><b>2.8</b> Structures de données</a>
<ul>
<li class="chapter" data-level="2.8.1" data-path="R-intro.html"><a href="R-intro.html#vecteurs"><i class="fa fa-check"></i><b>2.8.1</b> Vecteurs</a></li>
<li class="chapter" data-level="2.8.2" data-path="R-intro.html"><a href="R-intro.html#opérateurs-logiques"><i class="fa fa-check"></i><b>2.8.2</b> Opérateurs logiques</a></li>
<li class="chapter" data-level="2.8.3" data-path="R-intro.html"><a href="R-intro.html#matrices"><i class="fa fa-check"></i><b>2.8.3</b> Matrices</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="R-intro.html"><a href="R-intro.html#dataframes"><i class="fa fa-check"></i><b>2.9</b> Data Frames</a>
<ul>
<li class="chapter" data-level="2.9.1" data-path="R-intro.html"><a href="R-intro.html#travailler-sur-des-data.frames"><i class="fa fa-check"></i><b>2.9.1</b> Travailler sur des <code>data.frames</code></a></li>
</ul></li>
<li class="chapter" data-level="2.10" data-path="R-intro.html"><a href="R-intro.html#les-bases-de-la-programmation-en-r"><i class="fa fa-check"></i><b>2.10</b> Les bases de la programmation en <code>R</code></a>
<ul>
<li class="chapter" data-level="2.10.1" data-path="R-intro.html"><a href="R-intro.html#variables"><i class="fa fa-check"></i><b>2.10.1</b> Variables</a></li>
<li class="chapter" data-level="2.10.2" data-path="R-intro.html"><a href="R-intro.html#contrôle-du-flux-conditions-si-alors"><i class="fa fa-check"></i><b>2.10.2</b> Contrôle du flux, conditions “si, alors”</a></li>
<li class="chapter" data-level="2.10.3" data-path="R-intro.html"><a href="R-intro.html#boucles"><i class="fa fa-check"></i><b>2.10.3</b> Boucles</a></li>
<li class="chapter" data-level="2.10.4" data-path="R-intro.html"><a href="R-intro.html#fonctions"><i class="fa fa-check"></i><b>2.10.4</b> Fonctions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="sum.html"><a href="sum.html"><i class="fa fa-check"></i><b>3</b> Travailler avec les données</a>
<ul>
<li class="chapter" data-level="3.1" data-path="sum.html"><a href="sum.html#statistiques-descriptives"><i class="fa fa-check"></i><b>3.1</b> Statistiques descriptives</a>
<ul>
<li class="chapter" data-level="" data-path="sum.html"><a href="sum.html#tendance-centrale"><i class="fa fa-check"></i>Tendance centrale</a></li>
<li class="chapter" data-level="" data-path="sum.html"><a href="sum.html#étendue"><i class="fa fa-check"></i>Étendue</a></li>
<li class="chapter" data-level="" data-path="sum.html"><a href="sum.html#variable-catégorielles"><i class="fa fa-check"></i>Variable catégorielles</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="sum.html"><a href="sum.html#graphiques"><i class="fa fa-check"></i><b>3.2</b> Graphiques</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="sum.html"><a href="sum.html#histograms"><i class="fa fa-check"></i><b>3.2.1</b> Histograms</a></li>
<li class="chapter" data-level="3.2.2" data-path="sum.html"><a href="sum.html#diagrammes-en-bâtons"><i class="fa fa-check"></i><b>3.2.2</b> Diagrammes en bâtons</a></li>
<li class="chapter" data-level="3.2.3" data-path="sum.html"><a href="sum.html#boîtes-à-moustaches"><i class="fa fa-check"></i><b>3.2.3</b> Boîtes à moustaches</a></li>
<li class="chapter" data-level="3.2.4" data-path="sum.html"><a href="sum.html#nuages-de-points"><i class="fa fa-check"></i><b>3.2.4</b> Nuages de points</a></li>
<li class="chapter" data-level="3.2.5" data-path="sum.html"><a href="sum.html#ggplot"><i class="fa fa-check"></i><b>3.2.5</b> <code>ggplot</code></a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="sum.html"><a href="sum.html#summarize-two"><i class="fa fa-check"></i><b>3.3</b> Statistiques bivariées</a></li>
<li class="chapter" data-level="3.4" data-path="sum.html"><a href="sum.html#le-tidyverse"><i class="fa fa-check"></i><b>3.4</b> Le <code>tidyverse</code></a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="sum.html"><a href="sum.html#primers-de-rstudio.cloud"><i class="fa fa-check"></i><b>3.4.1</b> Primers de rstudio.cloud</a></li>
<li class="chapter" data-level="3.4.2" data-path="sum.html"><a href="sum.html#importer-des-données-.csv-de-façon-tidy"><i class="fa fa-check"></i><b>3.4.2</b> Importer des données <code>.csv</code> de façon <em>tidy</em></a></li>
<li class="chapter" data-level="3.4.3" data-path="sum.html"><a href="sum.html#les-data.frames-tidy-sont-des-tibbles"><i class="fa fa-check"></i><b>3.4.3</b> Les <code>data.frames</code> “tidy” sont des <code>tibbles</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="mcarlo.html"><a href="mcarlo.html"><i class="fa fa-check"></i><b>4</b> Simulations de Monte-Carlo</a>
<ul>
<li class="chapter" data-level="4.1" data-path="mcarlo.html"><a href="mcarlo.html#un-premier-exemple"><i class="fa fa-check"></i><b>4.1</b> Un premier exemple</a></li>
<li class="chapter" data-level="4.2" data-path="mcarlo.html"><a href="mcarlo.html#généralisation-le-package-montecarlo"><i class="fa fa-check"></i><b>4.2</b> Généralisation : le package MonteCarlo</a></li>
<li class="chapter" data-level="4.3" data-path="mcarlo.html"><a href="mcarlo.html#avec-une-régression-par-mco"><i class="fa fa-check"></i><b>4.3</b> Avec une régression par MCO</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="MCO.html"><a href="MCO.html"><i class="fa fa-check"></i><b>5</b> La régression linéaire par MCO</a>
<ul>
<li class="chapter" data-level="5.1" data-path="MCO.html"><a href="MCO.html#la-commande-de-base-lm-et-summary"><i class="fa fa-check"></i><b>5.1</b> La commande de base : <code>lm()</code> et <code>summary()</code></a></li>
<li class="chapter" data-level="5.2" data-path="MCO.html"><a href="MCO.html#extraire-des-éléments-du-modèle"><i class="fa fa-check"></i><b>5.2</b> Extraire des éléments du modèle</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="MCO.html"><a href="MCO.html#données-du-modèles"><i class="fa fa-check"></i><b>5.2.1</b> Données du modèles</a></li>
<li class="chapter" data-level="5.2.2" data-path="MCO.html"><a href="MCO.html#manipulation-plus-avancée"><i class="fa fa-check"></i><b>5.2.2</b> Manipulation plus avancée</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="MCO.html"><a href="MCO.html#graphiques-danalyse-des-résidus"><i class="fa fa-check"></i><b>5.3</b> Graphiques d’analyse des résidus</a></li>
<li class="chapter" data-level="5.4" data-path="MCO.html"><a href="MCO.html#analyse-de-la-variance"><i class="fa fa-check"></i><b>5.4</b> Analyse de la variance</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="MCO.html"><a href="MCO.html#r2-et-hatsigma"><i class="fa fa-check"></i><b>5.4.1</b> <span class="math inline">\(R^2\)</span> et <span class="math inline">\(\hat\sigma\)</span></a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="MCO.html"><a href="MCO.html#retour-sur-summary"><i class="fa fa-check"></i><b>5.5</b> Retour sur <code>summary()</code></a></li>
<li class="chapter" data-level="5.6" data-path="MCO.html"><a href="MCO.html#les-mco-à-la-main"><i class="fa fa-check"></i><b>5.6</b> Les MCO à la main</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="hetero.html"><a href="hetero.html"><i class="fa fa-check"></i><b>6</b> Traitement de l’hétéroscédasticité</a>
<ul>
<li class="chapter" data-level="6.1" data-path="hetero.html"><a href="hetero.html#introduction-1"><i class="fa fa-check"></i><b>6.1</b> Introduction</a></li>
<li class="chapter" data-level="6.2" data-path="hetero.html"><a href="hetero.html#détection-de-lhétéroscédasticité"><i class="fa fa-check"></i><b>6.2</b> Détection de l’hétéroscédasticité</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="hetero.html"><a href="hetero.html#analyse-graphique-des-résidus"><i class="fa fa-check"></i><b>6.2.1</b> Analyse graphique des résidus</a></li>
<li class="chapter" data-level="6.2.2" data-path="hetero.html"><a href="hetero.html#test-de-breusch-pagan"><i class="fa fa-check"></i><b>6.2.2</b> Test de Breusch-Pagan</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="hetero.html"><a href="hetero.html#correction-de-white"><i class="fa fa-check"></i><b>6.3</b> Correction de White</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="hetero.html"><a href="hetero.html#les-paquets-lmtest-et-sandwich"><i class="fa fa-check"></i><b>6.3.1</b> Les paquets <code>lmtest</code> et <code>sandwich</code></a></li>
<li class="chapter" data-level="6.3.2" data-path="hetero.html"><a href="hetero.html#les-paquets-lmtest-et-car"><i class="fa fa-check"></i><b>6.3.2</b> Les paquets <code>lmtest</code> et <code>car</code></a></li>
<li class="chapter" data-level="6.3.3" data-path="hetero.html"><a href="hetero.html#le-paquet-estimatr"><i class="fa fa-check"></i><b>6.3.3</b> Le paquet <code>estimatr</code></a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="hetero.html"><a href="hetero.html#mcqg-par-pondération"><i class="fa fa-check"></i><b>6.4</b> MCQG par pondération</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="dsls.html"><a href="dsls.html"><i class="fa fa-check"></i><b>7</b> Variables instrumentales et doubles moindres carrés</a>
<ul>
<li class="chapter" data-level="7.1" data-path="dsls.html"><a href="dsls.html#introduction-2"><i class="fa fa-check"></i><b>7.1</b> Introduction</a></li>
<li class="chapter" data-level="7.2" data-path="dsls.html"><a href="dsls.html#la-méthode-des-variables-instrumentalesdoubles-moindres-carrés"><i class="fa fa-check"></i><b>7.2</b> La méthode des variables instrumentales/doubles moindres carrés</a></li>
<li class="chapter" data-level="7.3" data-path="dsls.html"><a href="dsls.html#implémentation-sous-r-la-commande-ivreg"><i class="fa fa-check"></i><b>7.3</b> Implémentation sous <code>R</code> : la commande <code>ivreg</code></a></li>
<li class="chapter" data-level="7.4" data-path="dsls.html"><a href="dsls.html#tests-de-diagnostics"><i class="fa fa-check"></i><b>7.4</b> Tests de diagnostics</a></li>
<li class="chapter" data-level="7.5" data-path="dsls.html"><a href="dsls.html#sls-à-la-main"><i class="fa fa-check"></i><b>7.5</b> 2SLS à la main</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="panel.html"><a href="panel.html"><i class="fa fa-check"></i><b>8</b> Donées de panel</a>
<ul>
<li class="chapter" data-level="8.1" data-path="panel.html"><a href="panel.html#introduction-3"><i class="fa fa-check"></i><b>8.1</b> Introduction</a></li>
<li class="chapter" data-level="8.2" data-path="panel.html"><a href="panel.html#le-modèle-à-effets-fixes"><i class="fa fa-check"></i><b>8.2</b> Le modèle à effets fixes</a></li>
<li class="chapter" data-level="8.3" data-path="panel.html"><a href="panel.html#le-modèle-à-effets-aléatoires"><i class="fa fa-check"></i><b>8.3</b> Le modèle à effets aléatoires</a></li>
<li class="chapter" data-level="8.4" data-path="panel.html"><a href="panel.html#le-test-dhausman"><i class="fa fa-check"></i><b>8.4</b> Le test d’Hausman</a></li>
<li class="chapter" data-level="8.5" data-path="panel.html"><a href="panel.html#implémentation-sous-r"><i class="fa fa-check"></i><b>8.5</b> Implémentation sous <code>R</code></a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R à Paris 8</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="mcarlo" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Simulations de Monte-Carlo</h1>
<p>Il est souvent utilse de faire des <em>simulations de Monte-Carlo</em> afin d’étudier les propriétés des estimateurs que nous rencontrerons, et de “visualiser” leurs comprtements. Ces propriétés (biais, convergence, efficacité etc.) sont des propriétés <em>statistques</em> qui ont trait à la <em>distribution</em> des estimateurs, vus comme une variables aléatoire. Une simulation de Monte-Carlo consiste en quelque sortes à tirer plein de valeurs de ces variables aléatoires afin d’étudier leurs distribution.</p>
<div id="un-premier-exemple" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Un premier exemple</h2>
<p>Votre cours de statistrique et de probabilité vous a (normalement) appris que la moyenne d’un échantillon de taille <span class="math inline">\(n\)</span> issu d’une loi Normale <span class="math inline">\(N(\mu,\sigma^2)\)</span> de moyenne <span class="math inline">\(\mu\)</span> et d’écart-type <span class="math inline">\(\sigma\)</span> est une variable aléatoire suivant une loi normale de moyenne <span class="math inline">\(\mu\)</span> et d’écart-type <span class="math inline">\(\frac{\sigma}{\sqrt{n}}\)</span>. Utilisons <code>R</code> pour le vérifier.</p>
<p>Commençons par calculer la moyenne d’un échantillon de 100 tirages d’une <span class="math inline">\(N(0,1)\)</span></p>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="mcarlo.html#cb248-1" aria-hidden="true"></a>n &lt;-<span class="st"> </span><span class="dv">100</span> </span>
<span id="cb248-2"><a href="mcarlo.html#cb248-2" aria-hidden="true"></a>mu &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb248-3"><a href="mcarlo.html#cb248-3" aria-hidden="true"></a>sigma &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb248-4"><a href="mcarlo.html#cb248-4" aria-hidden="true"></a>x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n,<span class="dt">mean=</span>mu,<span class="dt">sd=</span>sigma)</span>
<span id="cb248-5"><a href="mcarlo.html#cb248-5" aria-hidden="true"></a><span class="kw">mean</span>(x)</span></code></pre></div>
<pre><code>## [1] -0.1976099</code></pre>
<p>On voit que la moyenne des 100 tirages n’est pas strictement égale à 0, et on ne voit pas bien comment juger de l’écart-type ou de la loi de probabilité de cette moyenne. Si on lance le code une seconde fois, le résultat va d’ailleurs changer :</p>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="mcarlo.html#cb250-1" aria-hidden="true"></a>n &lt;-<span class="st"> </span><span class="dv">100</span> </span>
<span id="cb250-2"><a href="mcarlo.html#cb250-2" aria-hidden="true"></a>mu &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb250-3"><a href="mcarlo.html#cb250-3" aria-hidden="true"></a>sigma &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb250-4"><a href="mcarlo.html#cb250-4" aria-hidden="true"></a>x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n,<span class="dt">mean=</span>mu,<span class="dt">sd=</span>sigma)</span>
<span id="cb250-5"><a href="mcarlo.html#cb250-5" aria-hidden="true"></a><span class="kw">mean</span>(x)</span></code></pre></div>
<pre><code>## [1] -0.1302389</code></pre>
<p>La raison est que la théorie nous donne les caractéristiques de la <em>distribution</em> de cette moyenne au travers d’un grand nombre d’échantillons de 1000 tirages d’une <span class="math inline">\(N(0,1)\)</span>. Nous allons donc répéter le code ci-dessous un grand nombre de fois (<span class="math inline">\(K\)</span> fois), noter à chaque fois la moyenne obtenue, et étudier la distribution de ces <span class="math inline">\(K\)</span> moyennes</p>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="mcarlo.html#cb252-1" aria-hidden="true"></a>K &lt;-<span class="st"> </span><span class="dv">10000</span> <span class="co"># On va faire 10000 réplications, on aura donc 10000 moyennes</span></span>
<span id="cb252-2"><a href="mcarlo.html#cb252-2" aria-hidden="true"></a>n &lt;-<span class="st"> </span><span class="dv">100</span></span>
<span id="cb252-3"><a href="mcarlo.html#cb252-3" aria-hidden="true"></a>mu &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb252-4"><a href="mcarlo.html#cb252-4" aria-hidden="true"></a>sigma &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb252-5"><a href="mcarlo.html#cb252-5" aria-hidden="true"></a>moyennes &lt;-<span class="st"> </span><span class="kw">c</span>() <span class="co"># On crée un vecteur vide qui contiendra les K moyennes</span></span>
<span id="cb252-6"><a href="mcarlo.html#cb252-6" aria-hidden="true"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>K) { <span class="co"># on initialise la boucle</span></span>
<span id="cb252-7"><a href="mcarlo.html#cb252-7" aria-hidden="true"></a>  x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n,<span class="dt">mean=</span>mu,<span class="dt">sd=</span>sigma) <span class="co"># on tire l&#39;ééchantillon</span></span>
<span id="cb252-8"><a href="mcarlo.html#cb252-8" aria-hidden="true"></a>  moyennes[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(x) <span class="co"># on stocke la moyenne issue de la ième réplication à</span></span>
<span id="cb252-9"><a href="mcarlo.html#cb252-9" aria-hidden="true"></a>                          <span class="co"># la ième position du vecteur &quot;moyennes&quot;</span></span>
<span id="cb252-10"><a href="mcarlo.html#cb252-10" aria-hidden="true"></a>}</span>
<span id="cb252-11"><a href="mcarlo.html#cb252-11" aria-hidden="true"></a>moyennes[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>] <span class="co"># on affiche les 10 premières moyennes</span></span></code></pre></div>
<pre><code>##  [1]  0.04769265 -0.05984550 -0.11143053 -0.05447702  0.22417867  0.05566776
##  [7]  0.02042009 -0.02819722  0.03614298  0.14477268</code></pre>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="mcarlo.html#cb254-1" aria-hidden="true"></a><span class="kw">mean</span>(moyennes) <span class="co"># moyenne des moyennes (0 en théorie)</span></span></code></pre></div>
<pre><code>## [1] -0.0009696851</code></pre>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="mcarlo.html#cb256-1" aria-hidden="true"></a><span class="kw">sd</span>(moyennes) <span class="co"># écart-type des moyennes (1/sqrt(n) en théorie)</span></span></code></pre></div>
<pre><code>## [1] 0.09965563</code></pre>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="mcarlo.html#cb258-1" aria-hidden="true"></a><span class="dv">1</span><span class="op">/</span><span class="kw">sqrt</span>(n) <span class="co"># valeur de 1/sqrt(n)</span></span></code></pre></div>
<pre><code>## [1] 0.1</code></pre>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="mcarlo.html#cb260-1" aria-hidden="true"></a><span class="kw">hist</span>(moyennes,<span class="dt">prob=</span><span class="ot">TRUE</span>) <span class="co"># on trace l&#39;histogramme des moyennes</span></span>
<span id="cb260-2"><a href="mcarlo.html#cb260-2" aria-hidden="true"></a><span class="kw">lines</span>(<span class="kw">density</span>(moyennes),<span class="dt">col=</span><span class="st">&quot;red&quot;</span>) <span class="co"># on y ajoute le tracé de la densité des moyennes</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-97-1.png" width="672" /></p>
<p>Ceux qui ont suivi le tutoriel “<em>Visualize Data</em>” peuvent utiliser les outils graphiques du package <code>ggplot2</code></p>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="mcarlo.html#cb261-1" aria-hidden="true"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb261-2"><a href="mcarlo.html#cb261-2" aria-hidden="true"></a><span class="kw">ggplot</span>(<span class="dt">mapping=</span><span class="kw">aes</span>(<span class="dt">x=</span>moyennes)) <span class="op">+</span></span>
<span id="cb261-3"><a href="mcarlo.html#cb261-3" aria-hidden="true"></a><span class="st">         </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">y=</span>..density..),<span class="dt">fill=</span><span class="st">&quot;grey&quot;</span>,<span class="dt">color=</span><span class="st">&quot;black&quot;</span>) <span class="op">+</span></span>
<span id="cb261-4"><a href="mcarlo.html#cb261-4" aria-hidden="true"></a><span class="st">          </span><span class="kw">geom_density</span>(<span class="dt">fill=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">alpha=</span><span class="fl">0.2</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-98-1.png" width="672" /></p>
<p>NB : le <code>y=..density..</code> indique à <code>geom_histogram</code> d’utiliser la densité en ordonnées, au lieu de la fréquence. Ça permet d’avoir l’histogramme et la courbe des densité à la même échelle.</p>
<p>On constate que
1. La moyenne des K=10000 moyennes est très proche de la moyenne théorique (0)
2. L’écart-type des K moyennes est très proche de l’écart-type théorique (0.1)
3. La distribution est proche de celle d’une loi normale</p>
</div>
<div id="généralisation-le-package-montecarlo" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Généralisation : le package MonteCarlo</h2>
<p>L’exemple précédent a montré que l’on pouvait assez facilement effectuer une simulation basique avec du code assez simple. Néanmoins, ce code ne permet de simuler qu’un seul scénario (valeurs de <span class="math inline">\(n\)</span>, de <span class="math inline">\(\mu\)</span> et de <span class="math inline">\(\sigma\)</span>) à la fois. Si on souhaite voir ce qu’il se passe lorsqu’on fait varier les paramètres de la simulation, il faudrait copier-coller le code de nombreuses fois et modifer à chaque fois les paramètres. De plus, il faudrait faire attention à sauvegarder les résultats dans des vecteurs différents à chaque fois.
Afin de s’éviter ces désagréments, le package MonteCarlo permet d’automatiser ces tâches pour nous.</p>
<p>On commence par charger le package <code>MonteCarlo</code> ainsi que <code>tidyverse</code> (voir les tutoriels)</p>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb262-1"><a href="mcarlo.html#cb262-1" aria-hidden="true"></a><span class="kw">library</span>(MonteCarlo) <span class="co"># doit avoir package Rcpp installé</span></span>
<span id="cb262-2"><a href="mcarlo.html#cb262-2" aria-hidden="true"></a><span class="kw">library</span>(tidyverse) <span class="co"># charge plein d&#39;outils utiles, voir les tutoriels sur rstudio.cloud</span></span></code></pre></div>
<p>On définit ensuite une fonction qui va effectuer le tirage de l’échantillon aléatoire, calculer la moyenne, et retourner le résultat :</p>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb263-1"><a href="mcarlo.html#cb263-1" aria-hidden="true"></a>simul_moyenne &lt;-<span class="st"> </span><span class="cf">function</span>(n,mu,sigma) { <span class="co"># Notre fonction s&#39;appelle &quot;simul_moyenne&quot; et prend les</span></span>
<span id="cb263-2"><a href="mcarlo.html#cb263-2" aria-hidden="true"></a>                                        <span class="co"># arguments n, mu et sigma</span></span>
<span id="cb263-3"><a href="mcarlo.html#cb263-3" aria-hidden="true"></a>  tirages &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n,<span class="dt">mean=</span>mu,<span class="dt">sd=</span>sigma) <span class="co"># on effectue le tirage aléatoire avec les valeurs données en argument</span></span>
<span id="cb263-4"><a href="mcarlo.html#cb263-4" aria-hidden="true"></a>  moy &lt;-<span class="st"> </span><span class="kw">mean</span>(tirages) <span class="co"># on calcule la moyenne</span></span>
<span id="cb263-5"><a href="mcarlo.html#cb263-5" aria-hidden="true"></a>  <span class="kw">return</span>(<span class="kw">list</span>(<span class="st">&quot;moyenne&quot;</span>=moy)) <span class="co"># on la retourne dans une liste nommée &quot;moyenne&quot;</span></span>
<span id="cb263-6"><a href="mcarlo.html#cb263-6" aria-hidden="true"></a>}</span></code></pre></div>
<p>On définit ensuite des vecteurs qui vont définir l’ensemble des “scénarios” de simulations, c’est à dire les valeurs des paramètres que l’ont veut faire varier. Ici on veut deux valeurs pour la taille d’échantillon, deux valeurs pour l’espérance, et trois pour l’écart-type</p>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="mcarlo.html#cb264-1" aria-hidden="true"></a>n_grid &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">100</span>) </span>
<span id="cb264-2"><a href="mcarlo.html#cb264-2" aria-hidden="true"></a>mu_grid &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">5</span>)</span>
<span id="cb264-3"><a href="mcarlo.html#cb264-3" aria-hidden="true"></a>sigma_grid &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>)</span></code></pre></div>
<p>On indique ensuite que le programme devra passer toutes les combinaisons de ces valeurs en tant qu’arguments à notre fonction “simul_moyenne”</p>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb265-1"><a href="mcarlo.html#cb265-1" aria-hidden="true"></a>param_list=<span class="kw">list</span>(<span class="st">&quot;n&quot;</span>=n_grid, <span class="st">&quot;mu&quot;</span>=mu_grid, <span class="st">&quot;sigma&quot;</span>=sigma_grid)</span></code></pre></div>
<p>On peut maintenant lancer <code>MonteCarlo</code> en lui indiquant quelle fonction utiliser, le nombre de réplications par scénario, et où trouver la liste des paramètres. On stocke les résultats dans un objet nommé “résultats”</p>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="mcarlo.html#cb266-1" aria-hidden="true"></a>resultats&lt;-<span class="kw">MonteCarlo</span>(<span class="dt">func=</span>simul_moyenne, <span class="dt">nrep=</span><span class="dv">10000</span>, <span class="dt">param_list=</span>param_list) </span></code></pre></div>
<p>Regardons ce que l’objet “résultats” contient :</p>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb267-1"><a href="mcarlo.html#cb267-1" aria-hidden="true"></a><span class="kw">summary</span>(resultats)</span></code></pre></div>
<pre><code>## Simulation of function: 
## 
## function(n,mu,sigma) { # Notre fonction s&#39;appelle &quot;simul_moyenne&quot; et prend les
##                                         # arguments n, mu et sigma
##   tirages &lt;- rnorm(n,mean=mu,sd=sigma) # on effectue le tirage aléatoire avec les valeurs données en argument
##   moy &lt;- mean(tirages) # on calcule la moyenne
##   return(list(&quot;moyenne&quot;=moy)) # on la retourne dans une liste nommée &quot;moyenne&quot;
## }
## &lt;bytecode: 0x55b7c4a2af10&gt;
## 
## Required time: 1.62 secs for nrep = 10000  repetitions on 1 CPUs 
## 
## Parameter grid: 
## 
##      n : 10 100 
##     mu : 0 5 
##  sigma : 1 2 4 
## 
##  
## 1 output arrays of dimensions: 2 2 3 10000</code></pre>
<p>On va le transformer les parties pertinentes en <code>data frame</code> (voir les tutoriels) pour une manipulation plus aisée. la fonction <code>head()</code> permet ensuite de lister les premières lignes d’une <code>data frame</code>, afin de vérifier rapidement son contenu.</p>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb269-1"><a href="mcarlo.html#cb269-1" aria-hidden="true"></a>data_resultats &lt;-<span class="kw">MakeFrame</span>(resultats)</span>
<span id="cb269-2"><a href="mcarlo.html#cb269-2" aria-hidden="true"></a><span class="kw">head</span>(data_resultats)</span></code></pre></div>
<pre><code>##     n mu sigma     moyenne
## 1  10  0     1 -0.02827005
## 2 100  0     1  0.01071684
## 3  10  5     1  4.98566732
## 4 100  5     1  4.96968491
## 5  10  0     2  0.55535111
## 6 100  0     2  0.36621319</code></pre>
<p>On va maintenant calculer les moyennes et écart-types des 10000 moyennes calculées pour chaque scénario de simulation. On fait appel aux outils de “pipe” (<code>%&gt;%</code>) et de groupe (<code>group_by()</code>) expliqués dans le tutoriel “<em>Work With Data</em>”. On en profite pour ajouter une variable “ecty_theor” donnant l’écart-type théorique de la distribution des moyennes</p>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb271-1"><a href="mcarlo.html#cb271-1" aria-hidden="true"></a>data_resultats <span class="op">%&gt;%</span></span>
<span id="cb271-2"><a href="mcarlo.html#cb271-2" aria-hidden="true"></a><span class="kw">mutate</span>(<span class="dt">ecty_theor=</span>sigma<span class="op">/</span><span class="kw">sqrt</span>(n)) <span class="op">%&gt;%</span><span class="st">  </span></span>
<span id="cb271-3"><a href="mcarlo.html#cb271-3" aria-hidden="true"></a><span class="kw">group_by</span>(n,mu,sigma) <span class="op">%&gt;%</span></span>
<span id="cb271-4"><a href="mcarlo.html#cb271-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">moy=</span><span class="kw">mean</span>(moyenne),<span class="dt">ecty=</span><span class="kw">sd</span>(moyenne),<span class="dt">ecty_theor=</span><span class="kw">mean</span>(ecty_theor))</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;n&#39;, &#39;mu&#39;. You can override using the `.groups` argument.</code></pre>
<pre><code>## # A tibble: 12 x 6
## # Groups:   n, mu [4]
##        n    mu sigma       moy   ecty ecty_theor
##    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt;
##  1    10     0     1 -0.00512  0.319       0.316
##  2    10     0     2 -0.00368  0.635       0.632
##  3    10     0     4  0.000882 1.27        1.26 
##  4    10     5     1  5.00     0.314       0.316
##  5    10     5     2  5.01     0.634       0.632
##  6    10     5     4  5.00     1.25        1.26 
##  7   100     0     1  0.000331 0.0990      0.1  
##  8   100     0     2  0.00493  0.200       0.2  
##  9   100     0     4  0.00267  0.403       0.4  
## 10   100     5     1  5.00     0.0992      0.1  
## 11   100     5     2  5.00     0.198       0.2  
## 12   100     5     4  5.00     0.401       0.4</code></pre>
<p>On constate que la moyenne des moyenne (colonne “moy”) est très proche de la moyenne théorique (“mu”), de même que l’écart-type de la distribution des moyennes (“ecty”) est très proche de l’écart-type théorique. Nos observations semblent bien coller avec la théorie.</p>
<p>On complète l’exercice en faisant un graphique de la fonction de densité estimées de nos résultats, pour chaque valeur de <span class="math inline">\(n\)</span>, <span class="math inline">\(\mu\)</span> et <span class="math inline">\(\sigma\)</span>.</p>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="mcarlo.html#cb274-1" aria-hidden="true"></a><span class="kw">ggplot</span>(<span class="dt">data=</span>data_resultats,<span class="dt">mapping=</span><span class="kw">aes</span>(<span class="dt">x=</span>moyenne,<span class="dt">group=</span>sigma,<span class="dt">color=</span><span class="kw">factor</span>(sigma))) <span class="op">+</span></span>
<span id="cb274-2"><a href="mcarlo.html#cb274-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_density</span>() <span class="op">+</span></span>
<span id="cb274-3"><a href="mcarlo.html#cb274-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">facet_wrap</span>(mu <span class="op">~</span><span class="st"> </span>n,<span class="dt">labeller=</span>label_both)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-107-1.png" width="672" /></p>
</div>
<div id="avec-une-régression-par-mco" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Avec une régression par MCO</h2>
<p><code>R</code> permet de faire une régression linéaire par MCO avec la commande <code>lm()</code>(voir le <a href="MCO.html#MCO">chapitre sur la répression par MCO</a>) ci-dessous</p>
<p>On va charger une base de données préinstallée avec <code>R</code> : les données “mtcars”</p>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb275-1"><a href="mcarlo.html#cb275-1" aria-hidden="true"></a><span class="kw">data</span>(mtcars)</span>
<span id="cb275-2"><a href="mcarlo.html#cb275-2" aria-hidden="true"></a><span class="kw">head</span>(mtcars)</span></code></pre></div>
<pre><code>##                    mpg cyl disp  hp drat    wt  qsec vs am gear carb
## Mazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4    4
## Mazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1    4    4
## Datsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1    4    1
## Hornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1
## Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2
## Valiant           18.1   6  225 105 2.76 3.460 20.22  1  0    3    1</code></pre>
<p>Effectuons une régression linaire de, par exemple, “mpg” sur “cyl” et “disp”</p>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb277-1"><a href="mcarlo.html#cb277-1" aria-hidden="true"></a><span class="kw">lm</span>(<span class="dt">data=</span>mtcars,mpg <span class="op">~</span><span class="st"> </span>cyl <span class="op">+</span><span class="st"> </span>disp)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = mpg ~ cyl + disp, data = mtcars)
## 
## Coefficients:
## (Intercept)          cyl         disp  
##    34.66099     -1.58728     -0.02058</code></pre>
<p>La sortie est assez minimale. Stockons cette régression dans un objet que nous appellerons “ma_regression” et faisons un <code>summary()</code> de ce dernier</p>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb279-1"><a href="mcarlo.html#cb279-1" aria-hidden="true"></a>ma_regression &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="dt">data=</span>mtcars,mpg <span class="op">~</span><span class="st"> </span>cyl <span class="op">+</span><span class="st"> </span>disp)</span>
<span id="cb279-2"><a href="mcarlo.html#cb279-2" aria-hidden="true"></a><span class="kw">summary</span>(ma_regression)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = mpg ~ cyl + disp, data = mtcars)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.4213 -2.1722 -0.6362  1.1899  7.0516 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 34.66099    2.54700  13.609 4.02e-14 ***
## cyl         -1.58728    0.71184  -2.230   0.0337 *  
## disp        -0.02058    0.01026  -2.007   0.0542 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 3.055 on 29 degrees of freedom
## Multiple R-squared:  0.7596, Adjusted R-squared:  0.743 
## F-statistic: 45.81 on 2 and 29 DF,  p-value: 1.058e-09</code></pre>
<p>On a déjà plus de détails.</p>
<p>On peut extraire divers éléments issus de <code>lm()</code> :</p>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb281-1"><a href="mcarlo.html#cb281-1" aria-hidden="true"></a><span class="kw">summary</span>(ma_regression)<span class="op">$</span>coef[,<span class="st">&quot;Estimate&quot;</span>] <span class="co"># les beta chapeau</span></span></code></pre></div>
<pre><code>## (Intercept)         cyl        disp 
## 34.66099474 -1.58727681 -0.02058363</code></pre>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb283-1"><a href="mcarlo.html#cb283-1" aria-hidden="true"></a><span class="kw">summary</span>(ma_regression)<span class="op">$</span>coef[,<span class="st">&quot;Std. Error&quot;</span>] <span class="co"># les écarts-type</span></span></code></pre></div>
<pre><code>## (Intercept)         cyl        disp 
##  2.54700388  0.71184427  0.01025748</code></pre>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb285-1"><a href="mcarlo.html#cb285-1" aria-hidden="true"></a><span class="kw">summary</span>(ma_regression)<span class="op">$</span>coef[,<span class="st">&quot;Estimate&quot;</span>][<span class="st">&quot;cyl&quot;</span>] <span class="co"># le beta chapeau de la variable &quot;cyl&quot;</span></span></code></pre></div>
<pre><code>##       cyl 
## -1.587277</code></pre>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb287-1"><a href="mcarlo.html#cb287-1" aria-hidden="true"></a><span class="kw">summary</span>(ma_regression)<span class="op">$</span>coef[,<span class="st">&quot;Estimate&quot;</span>][[<span class="st">&quot;cyl&quot;</span>]] <span class="co"># la même valeur, mais sans le nom associé, notez les doubles crochets </span></span></code></pre></div>
<pre><code>## [1] -1.587277</code></pre>
<p>On va maintenant utiliser ces éléments pour construire une simulation de Monte-Carlo de la distribution de l’estimateur des MCO <span class="math inline">\(\hat\beta_x\)</span> dans un cadre qui respecte les hypothèses de Gauss-Markov</p>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb289-1"><a href="mcarlo.html#cb289-1" aria-hidden="true"></a><span class="kw">library</span>(MonteCarlo) <span class="co"># doit avoir package Rcpp installé</span></span>
<span id="cb289-2"><a href="mcarlo.html#cb289-2" aria-hidden="true"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb289-3"><a href="mcarlo.html#cb289-3" aria-hidden="true"></a></span>
<span id="cb289-4"><a href="mcarlo.html#cb289-4" aria-hidden="true"></a>betareg&lt;-<span class="cf">function</span>(n) {</span>
<span id="cb289-5"><a href="mcarlo.html#cb289-5" aria-hidden="true"></a>  x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n,<span class="dt">mean=</span><span class="dv">0</span>,<span class="dt">sd=</span><span class="dv">1</span>)</span>
<span id="cb289-6"><a href="mcarlo.html#cb289-6" aria-hidden="true"></a>  epsilon &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n,<span class="dt">mean=</span><span class="dv">0</span>,<span class="dt">sd=</span><span class="dv">1</span>) <span class="co"># epsilon suit une loi normale non corrélée à x</span></span>
<span id="cb289-7"><a href="mcarlo.html#cb289-7" aria-hidden="true"></a>  y &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">+</span>x<span class="op">+</span>epsilon</span>
<span id="cb289-8"><a href="mcarlo.html#cb289-8" aria-hidden="true"></a>  mareg &lt;-<span class="st"> </span><span class="kw">lm</span>(y<span class="op">~</span>x)</span>
<span id="cb289-9"><a href="mcarlo.html#cb289-9" aria-hidden="true"></a>  coeffs &lt;-<span class="st"> </span><span class="kw">summary</span>(mareg)<span class="op">$</span>coef[,<span class="st">&quot;Estimate&quot;</span>]</span>
<span id="cb289-10"><a href="mcarlo.html#cb289-10" aria-hidden="true"></a>  betax &lt;-<span class="st"> </span>coeffs[[<span class="st">&quot;x&quot;</span>]]</span>
<span id="cb289-11"><a href="mcarlo.html#cb289-11" aria-hidden="true"></a>  <span class="kw">return</span>(<span class="kw">list</span>(<span class="st">&quot;betax&quot;</span>=betax))</span>
<span id="cb289-12"><a href="mcarlo.html#cb289-12" aria-hidden="true"></a>}</span>
<span id="cb289-13"><a href="mcarlo.html#cb289-13" aria-hidden="true"></a></span>
<span id="cb289-14"><a href="mcarlo.html#cb289-14" aria-hidden="true"></a>n_grid&lt;-<span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">100</span>)</span>
<span id="cb289-15"><a href="mcarlo.html#cb289-15" aria-hidden="true"></a></span>
<span id="cb289-16"><a href="mcarlo.html#cb289-16" aria-hidden="true"></a>param_list=<span class="kw">list</span>(<span class="st">&quot;n&quot;</span>=n_grid)</span></code></pre></div>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb290-1"><a href="mcarlo.html#cb290-1" aria-hidden="true"></a>resultats&lt;-<span class="kw">MonteCarlo</span>(<span class="dt">func=</span>betareg, <span class="dt">nrep=</span><span class="dv">10000</span>, <span class="dt">param_list=</span>param_list)</span></code></pre></div>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb291-1"><a href="mcarlo.html#cb291-1" aria-hidden="true"></a><span class="kw">summary</span>(resultats)</span></code></pre></div>
<pre><code>## Simulation of function: 
## 
## function(n) {
##   x &lt;- rnorm(n,mean=0,sd=1)
##   epsilon &lt;- rnorm(n,mean=0,sd=1) # epsilon suit une loi normale non corrélée à x
##   y &lt;- 1+x+epsilon
##   mareg &lt;- lm(y~x)
##   coeffs &lt;- summary(mareg)$coef[,&quot;Estimate&quot;]
##   betax &lt;- coeffs[[&quot;x&quot;]]
##   return(list(&quot;betax&quot;=betax))
## }
## &lt;bytecode: 0x55b7c5353d58&gt;
## 
## Required time: 13.96 secs for nrep = 10000  repetitions on 1 CPUs 
## 
## Parameter grid: 
## 
##  n : 10 100 
## 
##  
## 1 output arrays of dimensions: 2 10000</code></pre>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb293-1"><a href="mcarlo.html#cb293-1" aria-hidden="true"></a>data_resultats &lt;-<span class="kw">MakeFrame</span>(resultats)</span>
<span id="cb293-2"><a href="mcarlo.html#cb293-2" aria-hidden="true"></a><span class="kw">head</span>(data_resultats)</span></code></pre></div>
<pre><code>##     n     betax
## 1  10 1.4697435
## 2 100 0.9905716
## 3  10 1.0533390
## 4 100 1.1352285
## 5  10 1.3121881
## 6 100 1.2713152</code></pre>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb295-1"><a href="mcarlo.html#cb295-1" aria-hidden="true"></a>data_resultats <span class="op">%&gt;%</span></span>
<span id="cb295-2"><a href="mcarlo.html#cb295-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">group_by</span>(n) <span class="op">%&gt;%</span></span>
<span id="cb295-3"><a href="mcarlo.html#cb295-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">moy=</span><span class="kw">mean</span>(betax),<span class="dt">ecty=</span><span class="kw">sd</span>(betax))</span></code></pre></div>
<pre><code>## # A tibble: 2 x 3
##       n   moy  ecty
## * &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1    10 0.998 0.377
## 2   100 0.999 0.100</code></pre>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb297-1"><a href="mcarlo.html#cb297-1" aria-hidden="true"></a><span class="kw">ggplot</span>(<span class="dt">data=</span>data_resultats,<span class="dt">mapping=</span><span class="kw">aes</span>(<span class="dt">x=</span>betax,<span class="dt">group=</span>n,<span class="dt">color=</span><span class="kw">factor</span>(n)))<span class="op">+</span><span class="kw">geom_density</span>() </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-114-1.png" width="672" /></p>
<p>Les résultats ci-dessus sont-ils ceux que l’on s’attendait à avoir ? Que nous dit la théorie ?</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="sum.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="MCO.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
