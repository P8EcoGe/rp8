<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>8 Donées de panel | R à Paris 8</title>
  <meta name="description" content="8 Donées de panel | R à Paris 8" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="8 Donées de panel | R à Paris 8" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="8 Donées de panel | R à Paris 8" />
  
  
  



<meta name="date" content="2021-07-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="dsls.html"/>

<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Préface</a></li>
<li class="chapter" data-level="2" data-path="R-intro.html"><a href="R-intro.html"><i class="fa fa-check"></i><b>2</b> Introduction à <code>R</code></a>
<ul>
<li class="chapter" data-level="2.1" data-path="R-intro.html"><a href="R-intro.html#introduction"><i class="fa fa-check"></i><b>2.1</b> Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="R-intro.html"><a href="R-intro.html#démarrer-r-et-r-studio"><i class="fa fa-check"></i><b>2.2</b> Démarrer R et R Studio</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="R-intro.html"><a href="R-intro.html#un-premier-glossaire"><i class="fa fa-check"></i><b>2.2.1</b> Un premier glossaire</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="R-intro.html"><a href="R-intro.html#calculs-de-base"><i class="fa fa-check"></i><b>2.3</b> Calculs de base</a></li>
<li class="chapter" data-level="2.4" data-path="R-intro.html"><a href="R-intro.html#obtenir-de-laide"><i class="fa fa-check"></i><b>2.4</b> Obtenir de l’aide</a></li>
<li class="chapter" data-level="2.5" data-path="R-intro.html"><a href="R-intro.html#installation-de-packages"><i class="fa fa-check"></i><b>2.5</b> Installation de packages</a></li>
<li class="chapter" data-level="2.6" data-path="R-intro.html"><a href="R-intro.html#code-output"><i class="fa fa-check"></i><b>2.6</b> <code>Code</code> et sortie dans ce document</a></li>
<li class="chapter" data-level="2.7" data-path="R-intro.html"><a href="R-intro.html#data-types"><i class="fa fa-check"></i><b>2.7</b> Types de données</a></li>
<li class="chapter" data-level="2.8" data-path="R-intro.html"><a href="R-intro.html#structures-de-données"><i class="fa fa-check"></i><b>2.8</b> Structures de données</a>
<ul>
<li class="chapter" data-level="2.8.1" data-path="R-intro.html"><a href="R-intro.html#vecteurs"><i class="fa fa-check"></i><b>2.8.1</b> Vecteurs</a></li>
<li class="chapter" data-level="2.8.2" data-path="R-intro.html"><a href="R-intro.html#opérateurs-logiques"><i class="fa fa-check"></i><b>2.8.2</b> Opérateurs logiques</a></li>
<li class="chapter" data-level="2.8.3" data-path="R-intro.html"><a href="R-intro.html#matrices"><i class="fa fa-check"></i><b>2.8.3</b> Matrices</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="R-intro.html"><a href="R-intro.html#dataframes"><i class="fa fa-check"></i><b>2.9</b> Data Frames</a>
<ul>
<li class="chapter" data-level="2.9.1" data-path="R-intro.html"><a href="R-intro.html#travailler-sur-des-data.frames"><i class="fa fa-check"></i><b>2.9.1</b> Travailler sur des <code>data.frames</code></a></li>
</ul></li>
<li class="chapter" data-level="2.10" data-path="R-intro.html"><a href="R-intro.html#les-bases-de-la-programmation-en-r"><i class="fa fa-check"></i><b>2.10</b> Les bases de la programmation en <code>R</code></a>
<ul>
<li class="chapter" data-level="2.10.1" data-path="R-intro.html"><a href="R-intro.html#variables"><i class="fa fa-check"></i><b>2.10.1</b> Variables</a></li>
<li class="chapter" data-level="2.10.2" data-path="R-intro.html"><a href="R-intro.html#contrôle-du-flux-conditions-si-alors"><i class="fa fa-check"></i><b>2.10.2</b> Contrôle du flux, conditions “si, alors”</a></li>
<li class="chapter" data-level="2.10.3" data-path="R-intro.html"><a href="R-intro.html#boucles"><i class="fa fa-check"></i><b>2.10.3</b> Boucles</a></li>
<li class="chapter" data-level="2.10.4" data-path="R-intro.html"><a href="R-intro.html#fonctions"><i class="fa fa-check"></i><b>2.10.4</b> Fonctions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="sum.html"><a href="sum.html"><i class="fa fa-check"></i><b>3</b> Travailler avec les données</a>
<ul>
<li class="chapter" data-level="3.1" data-path="sum.html"><a href="sum.html#statistiques-descriptives"><i class="fa fa-check"></i><b>3.1</b> Statistiques descriptives</a>
<ul>
<li class="chapter" data-level="" data-path="sum.html"><a href="sum.html#tendance-centrale"><i class="fa fa-check"></i>Tendance centrale</a></li>
<li class="chapter" data-level="" data-path="sum.html"><a href="sum.html#étendue"><i class="fa fa-check"></i>Étendue</a></li>
<li class="chapter" data-level="" data-path="sum.html"><a href="sum.html#variable-catégorielles"><i class="fa fa-check"></i>Variable catégorielles</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="sum.html"><a href="sum.html#graphiques"><i class="fa fa-check"></i><b>3.2</b> Graphiques</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="sum.html"><a href="sum.html#histograms"><i class="fa fa-check"></i><b>3.2.1</b> Histograms</a></li>
<li class="chapter" data-level="3.2.2" data-path="sum.html"><a href="sum.html#diagrammes-en-bâtons"><i class="fa fa-check"></i><b>3.2.2</b> Diagrammes en bâtons</a></li>
<li class="chapter" data-level="3.2.3" data-path="sum.html"><a href="sum.html#boîtes-à-moustaches"><i class="fa fa-check"></i><b>3.2.3</b> Boîtes à moustaches</a></li>
<li class="chapter" data-level="3.2.4" data-path="sum.html"><a href="sum.html#nuages-de-points"><i class="fa fa-check"></i><b>3.2.4</b> Nuages de points</a></li>
<li class="chapter" data-level="3.2.5" data-path="sum.html"><a href="sum.html#ggplot"><i class="fa fa-check"></i><b>3.2.5</b> <code>ggplot</code></a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="sum.html"><a href="sum.html#summarize-two"><i class="fa fa-check"></i><b>3.3</b> Statistiques bivariées</a></li>
<li class="chapter" data-level="3.4" data-path="sum.html"><a href="sum.html#le-tidyverse"><i class="fa fa-check"></i><b>3.4</b> Le <code>tidyverse</code></a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="sum.html"><a href="sum.html#primers-de-rstudio.cloud"><i class="fa fa-check"></i><b>3.4.1</b> Primers de rstudio.cloud</a></li>
<li class="chapter" data-level="3.4.2" data-path="sum.html"><a href="sum.html#importer-des-données-.csv-de-façon-tidy"><i class="fa fa-check"></i><b>3.4.2</b> Importer des données <code>.csv</code> de façon <em>tidy</em></a></li>
<li class="chapter" data-level="3.4.3" data-path="sum.html"><a href="sum.html#les-data.frames-tidy-sont-des-tibbles"><i class="fa fa-check"></i><b>3.4.3</b> Les <code>data.frames</code> “tidy” sont des <code>tibbles</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="mcarlo.html"><a href="mcarlo.html"><i class="fa fa-check"></i><b>4</b> Simulations de Monte-Carlo</a>
<ul>
<li class="chapter" data-level="4.1" data-path="mcarlo.html"><a href="mcarlo.html#un-premier-exemple"><i class="fa fa-check"></i><b>4.1</b> Un premier exemple</a></li>
<li class="chapter" data-level="4.2" data-path="mcarlo.html"><a href="mcarlo.html#généralisation-le-package-montecarlo"><i class="fa fa-check"></i><b>4.2</b> Généralisation : le package MonteCarlo</a></li>
<li class="chapter" data-level="4.3" data-path="mcarlo.html"><a href="mcarlo.html#avec-une-régression-par-mco"><i class="fa fa-check"></i><b>4.3</b> Avec une régression par MCO</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="MCO.html"><a href="MCO.html"><i class="fa fa-check"></i><b>5</b> La régression linéaire par MCO</a>
<ul>
<li class="chapter" data-level="5.1" data-path="MCO.html"><a href="MCO.html#la-commande-de-base-lm-et-summary"><i class="fa fa-check"></i><b>5.1</b> La commande de base : <code>lm()</code> et <code>summary()</code></a></li>
<li class="chapter" data-level="5.2" data-path="MCO.html"><a href="MCO.html#extraire-des-éléments-du-modèle"><i class="fa fa-check"></i><b>5.2</b> Extraire des éléments du modèle</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="MCO.html"><a href="MCO.html#données-du-modèles"><i class="fa fa-check"></i><b>5.2.1</b> Données du modèles</a></li>
<li class="chapter" data-level="5.2.2" data-path="MCO.html"><a href="MCO.html#manipulation-plus-avancée"><i class="fa fa-check"></i><b>5.2.2</b> Manipulation plus avancée</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="MCO.html"><a href="MCO.html#graphiques-danalyse-des-résidus"><i class="fa fa-check"></i><b>5.3</b> Graphiques d’analyse des résidus</a></li>
<li class="chapter" data-level="5.4" data-path="MCO.html"><a href="MCO.html#analyse-de-la-variance"><i class="fa fa-check"></i><b>5.4</b> Analyse de la variance</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="MCO.html"><a href="MCO.html#r2-et-hatsigma"><i class="fa fa-check"></i><b>5.4.1</b> <span class="math inline">\(R^2\)</span> et <span class="math inline">\(\hat\sigma\)</span></a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="MCO.html"><a href="MCO.html#retour-sur-summary"><i class="fa fa-check"></i><b>5.5</b> Retour sur <code>summary()</code></a></li>
<li class="chapter" data-level="5.6" data-path="MCO.html"><a href="MCO.html#les-mco-à-la-main"><i class="fa fa-check"></i><b>5.6</b> Les MCO à la main</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="hetero.html"><a href="hetero.html"><i class="fa fa-check"></i><b>6</b> Traitement de l’hétéroscédasticité</a>
<ul>
<li class="chapter" data-level="6.1" data-path="hetero.html"><a href="hetero.html#introduction-1"><i class="fa fa-check"></i><b>6.1</b> Introduction</a></li>
<li class="chapter" data-level="6.2" data-path="hetero.html"><a href="hetero.html#détection-de-lhétéroscédasticité"><i class="fa fa-check"></i><b>6.2</b> Détection de l’hétéroscédasticité</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="hetero.html"><a href="hetero.html#analyse-graphique-des-résidus"><i class="fa fa-check"></i><b>6.2.1</b> Analyse graphique des résidus</a></li>
<li class="chapter" data-level="6.2.2" data-path="hetero.html"><a href="hetero.html#test-de-breusch-pagan"><i class="fa fa-check"></i><b>6.2.2</b> Test de Breusch-Pagan</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="hetero.html"><a href="hetero.html#correction-de-white"><i class="fa fa-check"></i><b>6.3</b> Correction de White</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="hetero.html"><a href="hetero.html#les-paquets-lmtest-et-sandwich"><i class="fa fa-check"></i><b>6.3.1</b> Les paquets <code>lmtest</code> et <code>sandwich</code></a></li>
<li class="chapter" data-level="6.3.2" data-path="hetero.html"><a href="hetero.html#les-paquets-lmtest-et-car"><i class="fa fa-check"></i><b>6.3.2</b> Les paquets <code>lmtest</code> et <code>car</code></a></li>
<li class="chapter" data-level="6.3.3" data-path="hetero.html"><a href="hetero.html#le-paquet-estimatr"><i class="fa fa-check"></i><b>6.3.3</b> Le paquet <code>estimatr</code></a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="hetero.html"><a href="hetero.html#mcqg-par-pondération"><i class="fa fa-check"></i><b>6.4</b> MCQG par pondération</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="dsls.html"><a href="dsls.html"><i class="fa fa-check"></i><b>7</b> Variables instrumentales et doubles moindres carrés</a>
<ul>
<li class="chapter" data-level="7.1" data-path="dsls.html"><a href="dsls.html#introduction-2"><i class="fa fa-check"></i><b>7.1</b> Introduction</a></li>
<li class="chapter" data-level="7.2" data-path="dsls.html"><a href="dsls.html#la-méthode-des-variables-instrumentalesdoubles-moindres-carrés"><i class="fa fa-check"></i><b>7.2</b> La méthode des variables instrumentales/doubles moindres carrés</a></li>
<li class="chapter" data-level="7.3" data-path="dsls.html"><a href="dsls.html#implémentation-sous-r-la-commande-ivreg"><i class="fa fa-check"></i><b>7.3</b> Implémentation sous <code>R</code> : la commande <code>ivreg</code></a></li>
<li class="chapter" data-level="7.4" data-path="dsls.html"><a href="dsls.html#tests-de-diagnostics"><i class="fa fa-check"></i><b>7.4</b> Tests de diagnostics</a></li>
<li class="chapter" data-level="7.5" data-path="dsls.html"><a href="dsls.html#sls-à-la-main"><i class="fa fa-check"></i><b>7.5</b> 2SLS à la main</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="panel.html"><a href="panel.html"><i class="fa fa-check"></i><b>8</b> Donées de panel</a>
<ul>
<li class="chapter" data-level="8.1" data-path="panel.html"><a href="panel.html#introduction-3"><i class="fa fa-check"></i><b>8.1</b> Introduction</a></li>
<li class="chapter" data-level="8.2" data-path="panel.html"><a href="panel.html#le-modèle-à-effets-fixes"><i class="fa fa-check"></i><b>8.2</b> Le modèle à effets fixes</a></li>
<li class="chapter" data-level="8.3" data-path="panel.html"><a href="panel.html#le-modèle-à-effets-aléatoires"><i class="fa fa-check"></i><b>8.3</b> Le modèle à effets aléatoires</a></li>
<li class="chapter" data-level="8.4" data-path="panel.html"><a href="panel.html#le-test-dhausman"><i class="fa fa-check"></i><b>8.4</b> Le test d’Hausman</a></li>
<li class="chapter" data-level="8.5" data-path="panel.html"><a href="panel.html#implémentation-sous-r"><i class="fa fa-check"></i><b>8.5</b> Implémentation sous <code>R</code></a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R à Paris 8</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="panel" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Donées de panel</h1>
<div id="introduction-3" class="section level2" number="8.1">
<h2><span class="header-section-number">8.1</span> Introduction</h2>
<p>Dans les chapitres précédents, les données étaient implicitement des données <em>en coupe</em>, c’est-à-dire que chaque observation correspondant à un individu statistiques <em>i</em> différent. Les modèles étaient du type <span class="math inline">\(y_i=\beta_0+\beta_1 x_{1i}+\dots+\beta_K x_{Ki}+\epsilon_i\)</span>.</p>
<p>Il arrive frequemment que nous disposions de <em>données de panel</em> où l’on observe un groupe d’individus (indicées par <span class="math inline">\(i=1\dots n\)</span>) au travers de plusieurs périodes (indicées par <span class="math inline">\(t=1\dots T\)</span>). Le modèle s’écrit alors <span class="math inline">\(y_it=\beta_0+\beta_1x_{1it}+\dots+\beta_Kx_{Kit}+\alpha_i+\epsilon_{it}\)</span> où <span class="math inline">\(\alpha_i\)</span> est un <em>effet individuel</em> propre à l’individu <span class="math inline">\(i\)</span>, et supposé constant au travers des <span class="math inline">\(T\)</span> périodes d’observations, et où <span class="math inline">\(\epsilon_{it}\)</span></p>
<p>Le terme d’erreur <span class="math inline">\(\epsilon_{it}\)</span> sera considéré comme un terme d’erreur statndard des MCO : il respecte l’hypothèse d’exogénéité stricte ; il est également non autocorrélé, et homoscédastique.
La différence entre les divers estimateurs utilisables sur données de panel reposent sur les hypothèses que l’on fera sur l’effet individuel <span class="math inline">\(\alpha_i\)</span>.</p>
<p>Si on considère que l’effet individuel <span class="math inline">\(\alpha_i\)</span> est non corrélé aux variables explicatives <span class="math inline">\(x_1\dots x_K\)</span>, alors on va implémenter un <strong>modèle à effets aléatoires</strong>
Si par contre on pense que l’effet individuel <span class="math inline">\(\alpha_i\)</span> est potentiellement corrélé à au moins une variable explicative <span class="math inline">\(x_k\)</span>, alors on va implémenter un <strong>modèle à effets fixes</strong>
Le <strong>Test d’Hausman</strong> permet de trancher entre les deux modèles</p>
</div>
<div id="le-modèle-à-effets-fixes" class="section level2" number="8.2">
<h2><span class="header-section-number">8.2</span> Le modèle à effets fixes</h2>
<p>Dans le modèle à effets fixes, on considère que l’effet individuel <span class="math inline">\(\alpha_i\)</span> est potentiellement corrélé aux variables explicatives du modèle. Comme <span class="math inline">\(\alpha_i\)</span> est inobservé, on fait donc face à un bias de variable omises si on estime le modèles par MCO (ou MCG, voir la section sur le modèle à effets aléatoires). Comme <span class="math inline">\(\alpha_i\)</span> est supposé être constant au travers des <span class="math inline">\(T\)</span> observations de l’individu <span class="math inline">\(i\)</span>, une solution serait d’inclure dans les variables explicatives <span class="math inline">\(n\)</span> variables indicatrices <span class="math inline">\(I_i\)</span>, chacune valant 1 pour les <span class="math inline">\(T\)</span> observations de l’individu <span class="math inline">\(i\)</span>, et 0 sinon. C’est l’estimateur dit “LSDV” (Least Squares Dummy Variables). En principe celà résoud le biais de variable omise, et donc permet d’estimer sans biais les coefficients des variables explicatuves d’intérêt. En pratique, néanmoins, l’estimateur LSDV imposerait d’inclure un très grand nombre de variables explicatives dans le modèle (une variable par individu), ce qui le rend difficilement implémentable.</p>
<p>Une solution équivalente à l’estimateur LSDV est l’estimateur dit “within”. Cet estimateur utilise un résultat dit “Théorème de Frish-Waugh-Lowell” (cf cours de L3). Ce théorème nous permet d’estimer le modèle à effets fixes sans avoir à introduire les variables indicatrices. L’estimateur within consiste à appliquer les MCO sur <em>données transformées</em> où chaque variable est prise en différence par rapport à sa moyenne individuelle. En posant <span class="math inline">\(\tilde y_{it}=y_{it}-\bar y_i\)</span> et <span class="math inline">\(\tilde x_{kit}=x_{kit}-\bar x_{ki}\)</span>, l’estimateur within applique les MCO au modèle <span class="math inline">\(\tilde y_{it} = \beta_O + \beta_1 \tilde x_{1it}+\dots+\beta_K\tilde x_{Kit}+\epsilon_{it}\)</span>.</p>
<p>Le modèle à effet fixe permet l’estimation des <span class="math inline">\(\hat\beta\)</span> en présence d’un effet individuel corrélé aux variables explicatives. Son principal défaut est qu’il interdit l’estimation des paramètres associés aux variables explicatives fices dans le temps (car dans ce cas <span class="math inline">\(\tilde x_{kit}=0\)</span>)</p>
</div>
<div id="le-modèle-à-effets-aléatoires" class="section level2" number="8.3">
<h2><span class="header-section-number">8.3</span> Le modèle à effets aléatoires</h2>
<p>Dans le modèle à effets aléatoires, on suppose que l’effet individuel <span class="math inline">\(\alpha_i\)</span> est non corrélé avec les variables explicatives du modèle. C’est une hypothèse forte qui, si elle n’est pas exacte, fera que nos <span class="math inline">\(\hat\beta\)</span> seront biaisés. Si cette hypothèse est exacte, il sera possible d’estimer sans biais les <span class="math inline">\(\hat\beta\)</span>, y compris pour les variables fixes dans le temps (au contraire de l’estimateur witihn). On peut alors ré-écrire le modèle comme <span class="math inline">\(y_it=\beta_0+\beta_1x_{1it}+\dots+\beta_Kx_{Kit}+\alpha+u_{i}+\epsilon_{it}\)</span> où <span class="math inline">\(u_i\)</span> est un terme d’erreur individuel non corrélé aux variables explicatives, et également non corrélé à <span class="math inline">\(\epsilon_it\)</span>.
Le modèle à effets aléatoire utilise l’estimateur des Moindres Carrés Quasi Généralisés, car la présence du terme <span class="math inline">\(u_i\)</span> induit une forme d’autocorrélation entre les observations d’un même individu.</p>
</div>
<div id="le-test-dhausman" class="section level2" number="8.4">
<h2><span class="header-section-number">8.4</span> Le test d’Hausman</h2>
<p>Afin de déterminer si l’hypothèse sous-jacente du modèle à effets aléatoires (la non corrélation entre l’effet individuel et les variables explicative) est valide, on peut implémenter le test d’Hausman.
Ce test se base sur l’idée que si l’hypothèse de non corrélation entre <span class="math inline">\(\alpha_i\)</span> et les <span class="math inline">\(x_k\)</span> est correcte, alos l’estimateur à effet fixe et l’estimateur à effet aléatoire devraient fournir des <span class="math inline">\(\hat\beta\)</span> semblables (is sont tous les deux sans biais sous <span class="math inline">\(H0\)</span>, mais l’estimateur à effet aléatoire sera efficace). Par contre, si <span class="math inline">\(H0\)</span> est fausse, alors ils devraient donner des <span class="math inline">\(\hat\beta\)</span> différents car l’estimateur à effet aléatoire serait alors biaisé ; tandis que l’estimateur à effet fixe reste sans biais.
La statistique du test d’Hausman se base donc sur une mesure de la différence entre les deux vecteurs de paramètres estimés.</p>
</div>
<div id="implémentation-sous-r" class="section level2" number="8.5">
<h2><span class="header-section-number">8.5</span> Implémentation sous <code>R</code></h2>
<p>Il existe plusieurs paquets permettant l’estimation sur données de panel sous <code>R</code>. On utilisera ici le paquet <code>plm</code> (Panel Linear Models) qui se spécialise, comme son nom l’indique, sur l’estimation des modèles linéaires sur données de Panel.</p>
<p>Commençons par importer des données</p>
<div class="sourceCode" id="cb421"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb421-1"><a href="panel.html#cb421-1" aria-hidden="true"></a><span class="kw">library</span>(readr) <span class="co"># Pour importer des données</span></span>
<span id="cb421-2"><a href="panel.html#cb421-2" aria-hidden="true"></a></span>
<span id="cb421-3"><a href="panel.html#cb421-3" aria-hidden="true"></a>panel &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/ATerracol/P8Econ/master/data/panel101.csv&quot;</span>)</span></code></pre></div>
<p>La base de données contient 400 observations, correspondant à 20 pays (variable country) observés sur 20 années (variable year) par pays. On y observe également les variables x1, x2 variables au cours du temps pour un pays donné ; et la variable x3 fixe au cours du temps pour un pays donné. La base contient également la variable y, qu’on va utiliser comme variable à expliquer, les x constituant les variables explicatives.</p>
<p>Afin d’indiquer à <code>plm</code> quelles sont les variables permettant d’identifier les individus et les périodes, on va utilier la commande <code>pdata.frame</code> :</p>
<div class="sourceCode" id="cb422"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb422-1"><a href="panel.html#cb422-1" aria-hidden="true"></a><span class="kw">library</span>(plm) <span class="co"># On commence par charger le paquet plm</span></span>
<span id="cb422-2"><a href="panel.html#cb422-2" aria-hidden="true"></a></span>
<span id="cb422-3"><a href="panel.html#cb422-3" aria-hidden="true"></a><span class="co"># On crée un nouveau data.frame à l&#39;aide de la commande pdata.frame, en indiquant les variables indiquant l&#39;identifiant d&#39;invididu et de période</span></span>
<span id="cb422-4"><a href="panel.html#cb422-4" aria-hidden="true"></a>panelb &lt;-<span class="st"> </span><span class="kw">pdata.frame</span>(panel, <span class="dt">index=</span><span class="kw">c</span>(<span class="st">&quot;country&quot;</span>,<span class="st">&quot;year&quot;</span>)) </span></code></pre></div>
<p>On peut ensuite estimer les modèles à effet fixess ou aléatoire en spécifiant l’option <code>model=</code> au sein de la command <code>plm</code></p>
<div class="sourceCode" id="cb423"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb423-1"><a href="panel.html#cb423-1" aria-hidden="true"></a>fixed &lt;-<span class="kw">plm</span>(<span class="dt">data=</span>panelb, y <span class="op">~</span><span class="st"> </span>x1 <span class="op">+</span><span class="st"> </span>x2 <span class="op">+</span><span class="st"> </span>x3, <span class="dt">model=</span><span class="st">&quot;within&quot;</span>)</span>
<span id="cb423-2"><a href="panel.html#cb423-2" aria-hidden="true"></a>random &lt;-<span class="kw">plm</span>(<span class="dt">data=</span>panelb, y <span class="op">~</span><span class="st"> </span>x1 <span class="op">+</span><span class="st"> </span>x2 <span class="op">+</span><span class="st"> </span>x3, <span class="dt">model=</span><span class="st">&quot;random&quot;</span>)</span>
<span id="cb423-3"><a href="panel.html#cb423-3" aria-hidden="true"></a><span class="co"># On les compare</span></span>
<span id="cb423-4"><a href="panel.html#cb423-4" aria-hidden="true"></a><span class="kw">summary</span>(fixed)</span></code></pre></div>
<pre><code>## Oneway (individual) effect Within Model
## 
## Call:
## plm(formula = y ~ x1 + x2 + x3, data = panelb, model = &quot;within&quot;)
## 
## Balanced Panel: n = 20, T = 20, N = 400
## 
## Residuals:
##      Min.   1st Qu.    Median   3rd Qu.      Max. 
## -3.276772 -0.643815  0.029442  0.628518  3.002143 
## 
## Coefficients:
##    Estimate Std. Error t-value  Pr(&gt;|t|)    
## x1 0.991473   0.102664  9.6575 &lt; 2.2e-16 ***
## x2 0.970439   0.053748 18.0552 &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Total Sum of Squares:    826.76
## Residual Sum of Squares: 385.74
## R-Squared:      0.53343
## Adj. R-Squared: 0.50751
## F-statistic: 216.083 on 2 and 378 DF, p-value: &lt; 2.22e-16</code></pre>
<div class="sourceCode" id="cb425"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb425-1"><a href="panel.html#cb425-1" aria-hidden="true"></a><span class="kw">summary</span>(random)</span></code></pre></div>
<pre><code>## Oneway (individual) effect Random Effect Model 
##    (Swamy-Arora&#39;s transformation)
## 
## Call:
## plm(formula = y ~ x1 + x2 + x3, data = panelb, model = &quot;random&quot;)
## 
## Balanced Panel: n = 20, T = 20, N = 400
## 
## Effects:
##                 var std.dev share
## idiosyncratic 1.020   1.010 0.325
## individual    2.122   1.457 0.675
## theta: 0.8468
## 
## Residuals:
##      Min.   1st Qu.    Median   3rd Qu.      Max. 
## -3.042938 -0.701596  0.033314  0.649309  3.512979 
## 
## Coefficients:
##             Estimate Std. Error z-value Pr(&gt;|z|)    
## (Intercept) 0.744259   0.339807  2.1902  0.02851 *  
## x1          0.861133   0.098770  8.7186  &lt; 2e-16 ***
## x2          0.977088   0.054659 17.8761  &lt; 2e-16 ***
## x3          3.429725   1.720292  1.9937  0.04619 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Total Sum of Squares:    851.65
## Residual Sum of Squares: 418.66
## R-Squared:      0.50841
## Adj. R-Squared: 0.50468
## Chisq: 409.544 on 3 DF, p-value: &lt; 2.22e-16</code></pre>
<p>On constate que le modèle à effets fixes ne fournit pas de valeur <span class="math inline">\(\hat\beta\)</span> pour la variable <span class="math inline">\(x_3\)</span> (qui est fixe dans le temps), ni pour la constante (pour des raisons de normalisations, afin d’éviter la colinéarité parfaite avec les effets individuels). En revanche, comme expliqué dans les sections ci-dessus, le modèle à effets aléatoire permet d’estimer les paramètres de toutes les variables, y compris de celles qui sont fixes dans le temps.</p>
<p>Si le modèle à effets aléatoires semble attrayant car il permet d’estimer les paramètres de toutes les variables, il reste toutefois dépendant de l’hypothèse d’indépendance entre les effets individuels <span class="math inline">\(\alpha_i\)</span> et les variables explicatives du modèle. Si cette hypothèse n’est pas vérifiée, alors les paramètres du modèle à effet aléatoire seront biaisés. Afin de tester cette hypothèse de non corrélation, et trancher entre un modèle à effets aléatoire et un modèle à effets fixes, on peut utiliser un test d’Hausmann, à l’aide de la commande <code>phtest</code> incluse dans le paquet <code>plm</code> :</p>
<div class="sourceCode" id="cb427"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb427-1"><a href="panel.html#cb427-1" aria-hidden="true"></a><span class="kw">phtest</span>(fixed,random)</span></code></pre></div>
<pre><code>## 
##  Hausman Test
## 
## data:  y ~ x1 + x2 + x3
## chisq = 21.648, df = 2, p-value = 1.992e-05
## alternative hypothesis: one model is inconsistent</code></pre>
<p>La p-value nous indique que l’on rejette l’hypothèse nulle de non corréllation entre les effets individuels et les variables explicatives au seuil de 1 %. On en conclut donc que le modèle à effets aléatoire est biaisé et inadéquat dans notre situation, et on choisit de se baser sur les résultats du modèle à effets fixes.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="dsls.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
